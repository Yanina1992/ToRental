<app-table></app-table>
<!--Crea veicolo----------------------------------------------->
<div>
<h1>Nuovo veicolo</h1>
  <form>
    <h3>Inserisci i dati del veicolo</h3>

    <!--Tipo veicolo-->
    <div class="mb-3">
      <label for="tipo_veicolo_nome" class="form-label">Tipo veicolo</label>
      <select
        id="tipo_veicolo_nome"
        class="form-select"
        [(ngModel)]="selectedTipoVeicoloId"
        (ngModelChange)="onTipeVeicoloChange(selectedTipoVeicoloId)"
        name="tipoVeicolo"
      >
        <option
          *ngFor="let tipoVeicolo of tipiVeicoli"
          [value]="tipoVeicolo.id"
        >
          {{ tipoVeicolo.nome }}
        </option>
      </select>
    </div>

    <!--Marca-->
    <div class="mb-3">
      <label for="marca" class="form-label">Marca</label>
      <select
        id="marca"
        class="form-select"
        [(ngModel)]="selectedMarcaId"
        (ngModelChange)="onMarcaChange(selectedMarcaId)"
        name="marca"
      >
        <option *ngFor="let marca of marche" [value]="marca.id">
          {{ marca.nome }}
        </option>
      </select>
    </div>

    <!--Modello-->
    <div class="mb-3">
      <label for="modello" class="form-label">Modello</label>
      <select
        id="modello"
        class="form-select"
        [disabled]="!selectedMarcaId"
        [(ngModel)]="selectedModelloId"
        (ngModelChange)="onModelloChange(selectedModelloId)"
        name="modello"
      >
        <option *ngFor="let modello of modelli" [value]="modello.id">
          {{ modello.nome }}
        </option>
      </select>
    </div>

    <!--Cilindrata-->
    <div class="mb-3">
      <label for="cilindrata" class="form-label">Cilindrata</label>
      <input
        type="number"
        class="form-control"
        id="cilindrata"
        [(ngModel)]="veicoloForm.cilindrata"
        name="cilindrata"
      />
    </div>

    <!--Colore-->
    <div class="mb-3">
      <label for="colore" class="form-label">Colore</label>
      <input
      type="text"
      class="form-control"
      id="colore"
      [(ngModel)]="veicoloForm.colore"
      name="colore" />
    </div>

    <!--Destinazione d'uso-->
    <div class="mb-3">
      <label for="destinazione_uso_nome" class="form-label"
        >Destinazione d'uso</label
      >
      <select
        id="destinazione_uso_nome"
        class="form-select"
        [(ngModel)]="selectedDestinazioneUsoId"
        (ngModelChange)="onDestinazioneUsoChange(selectedDestinazioneUsoId)"
        name="destinazioneUso"
      >
        <option
          *ngFor="let destinazione of destinazioni"
          [value]="destinazione.id"
        >
          {{ destinazione.nome }}
        </option>
      </select>
    </div>

    <!--Massa-->
    <div class="mb-3">
      <label for="massa" class="form-label">Massa</label>
      <input
      type="text" 
      class="form-control" 
      id="massa" 
      [(ngModel)]="veicoloForm.massa"
      name="massa" />
    </div>

    <!--Numero assi-->
    <div class="mb-3">
      <label for="numero_assi" class="form-label">Numero assi</label>
      <input
        type="number"
        class="form-control"
        id="numero_assi"
        [(ngModel)]="veicoloForm.numero_assi"
        name="numero_assi"
      />
    </div>

    <!--Portata-->
    <div class="mb-3">
      <label for="portata" class="form-label">Portata</label>
      <input 
      type="number" 
      class="form-control" 
      id="portata" 
      [(ngModel)]="veicoloForm.portata"
      name="portata" />
    </div>

    <!--Potenza-->
    <div class="mb-3">
      <label for="potenza" class="form-label">Potenza</label>
      <input 
      type="number" 
      class="form-control" 
      id="potenza" 
      [(ngModel)]="veicoloForm.potenza"
      name="potenza" />
    </div>

    <!--Società-->
    <div class="mb-3">
      <label for="societa_nome" class="form-label">Società</label>
      <select
        id="societa_nome"
        class="form-select"
        [(ngModel)]="selectedSocietaId"
        (ngModelChange)="onSocietaChange(selectedSocietaId)"
        name="societa"
      >
        <option *ngFor="let societa of societas" [value]="societa.id">
          {{ societa.nome }}
        </option>
      </select>
    </div>

    <!--Targa-->
    <div class="mb-3">
      <label for="targa" class="form-label">Targa</label>
      <input 
      type="text" 
      class="form-control" 
      id="targa" 
      [(ngModel)]="veicoloForm.targa"
      name="targa" />
    </div>

    <!--Tipo alimentazione-->
    <div class="mb-3">
      <label for="tipo_alimentazione_nome" class="form-label"
        >Alimentazione</label
      >
      <select
        id="tipo_alimentazione_nome"
        class="form-select"
        [(ngModel)]="selectedAlimentazioneId"
        (ngModelChange)="onAlimentazioneChange(selectedAlimentazioneId)"
        name="alimentazione"
      >
        <option
          *ngFor="let tipoAlimentazione of tipiAlimentazione"
          [value]="tipoAlimentazione.id"
        >
          {{ tipoAlimentazione.nome }}
        </option>
      </select>
    </div>

    <!--Allestimento-->
    <div class="mb-3">
      <label for="tipo_allestimento_nome" class="form-label"
        >Allestimento</label
      >
      <select
        id="tipo_allestimento_nome"
        class="form-select"
        [(ngModel)]="selectedAllestimentoId"
        (ngModelChange)="onAllestimentoChange(selectedAllestimentoId)"
        name="allestimento"
      >
        <option
          *ngFor="let allestimento of allestimenti"
          [value]="allestimento.id"
        >
          {{ allestimento.nome }}
        </option>
      </select>
    </div>

    <!-- Tipo asse-->
    <div class="mb-3">
      <label for="tipo_asse_nome" class="form-label">Tipo asse</label>
      <select
        id="tipo_asse_nome"
        class="form-select"
        [(ngModel)]="selectedTipoAsseId"
        (ngModelChange)="onTipoAsseChange(selectedTipoAsseId)"
        name="tipoAsse"
      >
        <option *ngFor="let tipoAsse of tipiAsse" [value]="tipoAsse.id">
          {{ tipoAsse.nome }}
        </option>
      </select>
    </div>

    <!--Cambio-->
    <div class="mb-3">
      <label for="tipo_cambio_nome" class="form-label">Cambio</label>
      <select
        id="tipo_cambio_nome"
        class="form-select"
        [(ngModel)]="selectedCambioId"
        (ngModelChange)="onCambioChange(selectedCambioId)"
        name="cambio"
      >
        <option *ngFor="let tipoCambio of tipiCambio" [value]="tipoCambio.id">
          {{ tipoCambio.nome }}
        </option>
      </select>
    </div>

    <!--Data immatricolazione-->
    <div class="mb-3">
      <label for="data_immatricolazione" class="form-label"
        >Data immatricolazione</label
      >

      <div class="container-fluid">
        <div class="row">
          <!--<div class="col col-1 p-0">
            <i
              class="fa-solid fa-calendar-days form-control d-flex justify-content-center"
            ></i>
          </div>-->

          <div class="col col-9 p-0">
            <input
              class="form-control"
              placeholder="Scegli una data"
              [(ngModel)]="veicoloForm.data_immatricolazione"
              (click)="toggleDatePicker()"
              name="dataImmatricolazione"
              [value]="formatDate(model)"
              readonly
            />

            <!--<i class="fa-solid fa-calendar-days"></i>-->
          </div>

          <div class="col col-3 p-0">
            <button class="form-control" (click)="selectToday()">Oggi</button>
          </div>
        </div>
      </div>

      <ngb-datepicker
        #dp
        [(ngModel)]="model"
        (navigate)="date = $event.next"
        (closed)="isDatepickerOpen = false"
        *ngIf="isDatepickerOpen"
        name="datePicker"
      >
      </ngb-datepicker>

      <!--<div>Selected date: {{ model | json }}</div>-->
    </div>

    <button type="submit" class="btn btn-primary" (click)="creaVeicolo()" >Salva veicolo</button>
  </form>
</div>
